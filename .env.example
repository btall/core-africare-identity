# =============================================================================
# core-africare-identity - Configuration des Variables d'Environnement
# =============================================================================
#
# Ce fichier sert de template pour les variables d'environnement requises.
# Copier ce fichier en .env et remplir les valeurs appropriées:
#
#   cp .env.example .env
#
# IMPORTANT: Ne jamais committer le fichier .env (il contient des secrets)
# =============================================================================

# -----------------------------------------------------------------------------
# Service Identity
# -----------------------------------------------------------------------------
PROJECT_NAME=core-africare-identity
PROJECT_SLUG=identity
ENVIRONMENT=development  # development|staging|production
DEBUG=false

# -----------------------------------------------------------------------------
# API Configuration
# -----------------------------------------------------------------------------
API_GATEWAY_URL=http://api-gateway-service:8000

# -----------------------------------------------------------------------------
# Keycloak Authentication
# -----------------------------------------------------------------------------
# URL du serveur Keycloak (sans /auth/ à la fin pour Keycloak 17+)
KEYCLOAK_SERVER_URL=https://keycloak.africare.app/auth
# Realm Keycloak pour l'authentification
KEYCLOAK_REALM=africare
# Client ID spécifique au service
KEYCLOAK_CLIENT_ID=core-africare-identity
# Client Secret (SENSIBLE - ne pas partager)
KEYCLOAK_CLIENT_SECRET=cYRi-B9OO2Ufd1h1n1SduA

# -----------------------------------------------------------------------------
# Database Configuration
# -----------------------------------------------------------------------------
# PostgreSQL 18 avec SQLAlchemy 2.0 (asyncpg driver)
# Format: postgresql+asyncpg://user:password@host:port/database
SQLALCHEMY_DATABASE_URI=postgresql+asyncpg://core-africare-identity:vd8bveedbnBpMcYr_8qB6A@postgres:5432/core-africare-identity
# -----------------------------------------------------------------------------
# Azure Event Hub Configuration
# -----------------------------------------------------------------------------
# RECOMMANDÉ (Priorité 1): Utiliser Managed Identity avec DefaultAzureCredential
# Namespace Event Hub (FQDN complet)
AZURE_EVENTHUB_NAMESPACE=africare.servicebus.windows.net
# Nom de l'Event Hub pour publier les événements
AZURE_EVENTHUB_NAME=core-africare-identity
# Consumer Group pour consommer les événements
AZURE_EVENTHUB_CONSUMER_GROUP=core-africare-identity
# Liste des Event Hubs à consommer (séparés par virgules)
# Ex: "core-africare-identity,core-africare-ehr,apps-africare-notifications"
AZURE_EVENTHUB_CONSUMER_SOURCES=

# FALLBACK (Priorité 2): Connection String - optionnel, pour compatibilité
# Laisser vide pour utiliser DefaultAzureCredential (recommandé en production)
AZURE_EVENTHUB_CONNECTION_STRING=

# -----------------------------------------------------------------------------
# Azure Blob Storage Configuration (Event Hub Checkpoint Store)
# -----------------------------------------------------------------------------
# RECOMMANDÉ (Priorité 1): Utiliser Managed Identity avec DefaultAzureCredential
# URL du compte Blob Storage
AZURE_BLOB_STORAGE_ACCOUNT_URL=https://stafricare.blob.core.windows.net
# Nom du container pour les checkpoints
AZURE_EVENTHUB_BLOB_STORAGE_CONTAINER_NAME=eventhub-checkpoints

# FALLBACK (Priorité 2): Connection String - optionnel, pour compatibilité
# Laisser vide pour utiliser DefaultAzureCredential (recommandé en production)
AZURE_EVENTHUB_BLOB_STORAGE_CONNECTION_STRING=

# -----------------------------------------------------------------------------
# OpenTelemetry Configuration
# -----------------------------------------------------------------------------
# Nom du service pour OpenTelemetry
OTEL_SERVICE_NAME=core-africare-identity

# OpenTelemetry Collector endpoint
OTEL_EXPORTER_OTLP_ENDPOINT=http://grafana-otel:4317
OTEL_EXPORTER_OTLP_PROTOCOL=grpc
OTEL_EXPORTER_OTLP_INSECURE=true

# Exporters (otlp|console)
OTEL_LOGS_EXPORTER=otlp
OTEL_TRACES_EXPORTER=otlp
OTEL_METRICS_EXPORTER=otlp

# Log levels
OTEL_LOG_LEVEL=info
OTEL_PYTHON_LOG_LEVEL=info

# Python logging auto-instrumentation
OTEL_PYTHON_LOGGING_AUTO_INSTRUMENTATION_ENABLED=true
OTEL_PYTHON_LOG_CORRELATION=true

# -----------------------------------------------------------------------------
# CORS Configuration
# -----------------------------------------------------------------------------
# Origines autorisées (séparées par virgules ou format JSON)
# Ex: "http://localhost:3000,http://localhost:4200"
# ou: '["http://localhost:3000","http://localhost:4200"]'
ALLOWED_ORIGINS=http://localhost:3000,http://localhost:4200,https://app.africare.sn

# Hosts de confiance (séparés par virgules ou format JSON)
TRUSTED_HOSTS=localhost,127.0.0.1,app.africare.sn,*.africare.sn

# -----------------------------------------------------------------------------
# Internationalisation (i18n)
# -----------------------------------------------------------------------------
# Langues supportées (séparées par virgules)
SUPPORTED_LOCALES=fr,en
# Langue par défaut
DEFAULT_LOCALE=fr

# =============================================================================
# Variables Spécifiques par Environnement
# =============================================================================
#
# DEVELOPMENT:
#   - DEBUG=true
#   - OTEL_LOGS_EXPORTER=console
#   - ALLOWED_ORIGINS=http://localhost:3000,http://localhost:4200
#
# STAGING:
#   - DEBUG=false
#   - ENVIRONMENT=staging
#   - OTEL_EXPORTER_OTLP_ENDPOINT=https://otel-collector-staging.africare.sn
#
# PRODUCTION:
#   - DEBUG=false
#   - ENVIRONMENT=production
#   - OTEL_EXPORTER_OTLP_ENDPOINT=https://otel-collector.africare.sn
#   - Utiliser UNIQUEMENT Managed Identity (pas de connection strings)
# =============================================================================
